function A = buildA(x_k, coords_k, asgdPlanes, x_k_o, tau)
%BUILDA Sets up the design matrix
%   INFO: derivatives computed by script "derivatives.m"
%   Inputs:
%       - x_k: states of current epoch (16x1)
%       - coords_k: points assigned to panels (nx3) [m]
%       - asgdPlanes: plane parameters of assigned panels (nx4) [-|m]
%       - x_k_o: states of prior epoch (16x1)
%       - tau: vector for interpolation (nx1, between 0 and 1)
%   Outputs:
%       - A: design matrix (nx15)
%
% Copyright (c) 2023 Dominik Ernst under MIT License

    % states (current)
    qw = x_k(7);
    qx = x_k(8);
    qy = x_k(9);
    qz = x_k(10);
    % states (old)
    qw_o = x_k_o(7);
    qx_o = x_k_o(8);
    qy_o = x_k_o(9);
    qz_o = x_k_o(10);
    % observations
    x = coords_k(:,1);
    y = coords_k(:,2);
    z = coords_k(:,3);
    % plane params
    ax = asgdPlanes(:,1);
    ay = asgdPlanes(:,2);
    az = asgdPlanes(:,3);
    
    A = zeros(size(coords_k,1), size(x_k,1)-1); % [p x u-1 (error state)]
    
    % check for difference between old and new rotation
    dq = qw.*qw_o + qx.*qx_o + qy.*qy_o + qz.*qz_o;

    if abs(1 - dq) < 1e-10 % avoid numerical problems when no rotation change occurs
        % non-interpolated version
        A(:,1:3) = [ax, ay, az];
        A(:,7) = (qy.*(az.*(z.*(qz + qz) + 2.*x.*qx + 2.*y.*qy) - ax.*(2.*qw.*y - 2.*qx.*z + x.*(qz + qz)) + ay.*(2.*qw.*x + 2.*qy.*z - y.*(qz + qz))))/2 - (qz.*(ay.*(y.*(qy + qy) + 2.*x.*qx + 2.*z.*qz) + ax.*(2.*qx.*y + 2.*qw.*z - x.*(qy + qy)) - az.*(2.*qw.*x - 2.*qz.*y + z.*(qy + qy))))/2 - (qx.*(ax.*(2.*qw.*x - 2.*qz.*y + 2.*qy.*z) + ay.*(2.*qz.*x + 2.*qw.*y - 2.*qx.*z) + az.*(2.*qx.*y - 2.*qy.*x + 2.*qw.*z)))/2 + (qw.*(ax.*(x.*(qx + qx) + 2.*y.*qy + 2.*z.*qz) - ay.*(2.*qw.*z - 2.*qy.*x + y.*(qx + qx)) + az.*(2.*qz.*x + 2.*qw.*y - z.*(qx + qx))))/2;
        A(:,8) = (qz.*(ax.*(x.*(qx + qx) + 2.*y.*qy + 2.*z.*qz) - ay.*(2.*qw.*z - 2.*qy.*x + y.*(qx + qx)) + az.*(2.*qz.*x + 2.*qw.*y - z.*(qx + qx))))/2 - (qx.*(az.*(z.*(qz + qz) + 2.*x.*qx + 2.*y.*qy) - ax.*(2.*qw.*y - 2.*qx.*z + x.*(qz + qz)) + ay.*(2.*qw.*x + 2.*qy.*z - y.*(qz + qz))))/2 - (qy.*(ax.*(2.*qw.*x - 2.*qz.*y + 2.*qy.*z) + ay.*(2.*qz.*x + 2.*qw.*y - 2.*qx.*z) + az.*(2.*qx.*y - 2.*qy.*x + 2.*qw.*z)))/2 + (qw.*(ay.*(y.*(qy + qy) + 2.*x.*qx + 2.*z.*qz) + ax.*(2.*qx.*y + 2.*qw.*z - x.*(qy + qy)) - az.*(2.*qw.*x - 2.*qz.*y + z.*(qy + qy))))/2;
        A(:,9) = (qx.*(ay.*(y.*(qy + qy) + 2.*x.*qx + 2.*z.*qz) + ax.*(2.*qx.*y + 2.*qw.*z - x.*(qy + qy)) - az.*(2.*qw.*x - 2.*qz.*y + z.*(qy + qy))))/2 - (qy.*(ax.*(x.*(qx + qx) + 2.*y.*qy + 2.*z.*qz) - ay.*(2.*qw.*z - 2.*qy.*x + y.*(qx + qx)) + az.*(2.*qz.*x + 2.*qw.*y - z.*(qx + qx))))/2 - (qz.*(ax.*(2.*qw.*x - 2.*qz.*y + 2.*qy.*z) + ay.*(2.*qz.*x + 2.*qw.*y - 2.*qx.*z) + az.*(2.*qx.*y - 2.*qy.*x + 2.*qw.*z)))/2 + (qw.*(az.*(z.*(qz + qz) + 2.*x.*qx + 2.*y.*qy) - ax.*(2.*qw.*y - 2.*qx.*z + x.*(qz + qz)) + ay.*(2.*qw.*x + 2.*qy.*z - y.*(qz + qz))))/2;
    else 
        % interpolated version
        A(:,1:3) = [tau .* ax, tau .* ay, tau .* az];
        A(:,7) = ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qx)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qz)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qy)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((qw_o.*sin(acos(dq).*(tau - 1)))/(2.*(1 - (dq).^2).^(1/2)) - (qw.*sin(tau.*acos(dq)))/(2.*(1 - (dq).^2).^(1/2))).*(ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))));
        A(:,8) = ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qy)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qz)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qx)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((qw_o.*sin(acos(dq).*(tau - 1)))/(2.*(1 - (dq).^2).^(1/2)) - (qw.*sin(tau.*acos(dq)))/(2.*(1 - (dq).^2).^(1/2))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))));
        A(:,9) = ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qz)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2) - (2.*qw_o.*qw_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw_o.*qw_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (2.*qw.*sin(tau.*acos(dq)).*qw_o.*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw.*tau.*cos(tau.*acos(dq)).*qw_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qw_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qw_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qw_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qy)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qx_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qx_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qx.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) + (qx.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qx_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qx_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qx_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qx_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qx_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qx_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qx_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qx_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qx_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/(2.*conj((1 - (dq).^2).^(1/2))) - (sin(conj(acos(dq)).*tau).*qx)/(2.*conj((1 - (dq).^2).^(1/2)))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - x.*(((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qy_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qy_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qy.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) + (qy.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qy_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qz_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qz_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qz.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qz.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qy_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qy_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qy_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qy_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qy_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qy_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qy_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qy_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)))) - ((qw_o.*sin(acos(dq).*(tau - 1)))/(2.*(1 - (dq).^2).^(1/2)) - (qw.*sin(tau.*acos(dq)))/(2.*(1 - (dq).^2).^(1/2))).*(ax.*(x.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + y.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + z.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) - az.*(z.*(((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - y.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))) + ay.*(y.*(((sin(conj(acos(dq)).*(tau - 1)).*qy_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qy)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) - ((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2) + ((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qy.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qy.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qy_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qy_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) + x.*(2.*((sin(conj(acos(dq)).*(tau - 1)).*qx_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qx)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((qz_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qz.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(tau.*acos(dq))/(1 - (dq).^2).^(1/2) - (qz_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) - (qz_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) + (qz.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) + (qz.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qz_o.*cos(conj(acos(dq)).*tau).*qx.*tau)/conj((1 - (dq).^2).^(1/2)).^2 - (qz_o.*sin(conj(acos(dq)).*tau).*qx.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qx_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qx_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2)) - z.*(((qx_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qx.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((2.*qw_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (2.*qw_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (2.*qw.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (2.*qw.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) - 2.*((sin(conj(acos(dq)).*(tau - 1)).*qz_o)/conj((1 - (dq).^2).^(1/2)) - (sin(conj(acos(dq)).*tau).*qz)/conj((1 - (dq).^2).^(1/2))).*((qy_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qy_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qy.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qy.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + ((2.*qw_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (2.*qw.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*((qx_o.*qz_o.*sin(acos(dq).*(tau - 1)).*(dq))/(1 - (dq).^2).^(3/2) + (qx_o.*qz_o.*cos(acos(dq).*(tau - 1)).*(tau - 1))/((dq).^2 - 1) - (qx.*sin(tau.*acos(dq)).*qz_o.*(dq))/(1 - (dq).^2).^(3/2) - (qx.*tau.*cos(tau.*acos(dq)).*qz_o)/((dq).^2 - 1)) + 2.*((qy_o.*sin(acos(dq).*(tau - 1)))/(1 - (dq).^2).^(1/2) - (qy.*sin(tau.*acos(dq)))/(1 - (dq).^2).^(1/2)).*(sin(conj(acos(dq)).*tau)/conj((1 - (dq).^2).^(1/2)) - (qz_o.*cos(conj(acos(dq)).*tau).*qz.*tau)/conj((1 - (dq).^2).^(1/2)).^2 + (qz_o.*sin(conj(acos(dq)).*tau).*qz.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 - (qz_o.*sin(conj(acos(dq)).*(tau - 1)).*qz_o.*(qw_o.*qw + qx_o.*qx + qy_o.*qy + qz_o.*qz))/conj((1 - (dq).^2).^(1/2)).^3 + (qz_o.*cos(conj(acos(dq)).*(tau - 1)).*qz_o.*(tau - 1))/conj((1 - (dq).^2).^(1/2)).^2))));
    end

end